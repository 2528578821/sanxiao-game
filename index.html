<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#ffffff" />
    <title>三消小游戏</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="background"></div>
    <div class="app">
      <header class="topbar">
        <div class="brand">
          <div class="title">三消</div>
          <div class="subtitle" id="subTitle">滑动交换，连成三颗即可消除</div>
        </div>
        <div class="hud">
          <div class="stat">
            <div class="label">关卡</div>
            <div class="value" id="level">1</div>
          </div>
          <div class="stat">
            <div class="label">步数</div>
            <div class="value" id="moves">0</div>
          </div>
          <div class="stat" id="timerStat" style="display:none">
            <div class="label">时间</div>
            <div class="value" id="timer">0</div>
          </div>
          <div class="stat wide">
            <div class="label">目标</div>
            <div class="value" id="goal">-</div>
            <div class="progressBar">
              <div class="progressFill" id="progressFill"></div>
              <div class="starMarker star1">★</div>
              <div class="starMarker star2">★</div>
              <div class="starMarker star3">★</div>
            </div>
          </div>
          <div class="stat">
            <div class="label">分数</div>
            <div class="value" id="score">0</div>
          </div>
          <div class="stat">
            <div class="label">连消</div>
            <div class="value" id="combo">0</div>
          </div>
          <button class="btn ghost" id="menuBtn" type="button">菜单</button>
          <button class="btn ghost" id="settingsBtn" type="button">设置</button>
          <button class="btn" id="restartBtn" type="button">重开</button>
        </div>
      </header>
 
      <main class="main">
        <section class="boardWrap">
          <div class="board" id="board" aria-label="三消棋盘" role="application"></div>
          <div class="controls">
            <button class="btn small" id="hintBtn" type="button">提示</button>
            <button class="btn small" id="bombBtn" type="button">炸弹 <span class="pill" id="bombCount">0</span></button>
            <button class="btn small" id="rainbowBtn" type="button">彩虹球 <span class="pill" id="rainbowCount">0</span></button>
          </div>
          <div class="hint" id="hint">在格子上滑动（上下左右）交换</div>
        </section>
      </main>

      <footer class="footer">
        <div class="small">提示：手机上建议全屏浏览器；也可后续做成可安装的 PWA。</div>
      </footer>
    </div>

    <div class="toast" id="toast" aria-live="polite" aria-atomic="true"></div>

    <div class="overlay" id="loadingOverlay" hidden>
      <div class="card">
        <div class="cardTitle">加载中</div>
        <div class="cardText">正在准备关卡与棋盘…</div>
        <div class="loader"></div>
      </div>
    </div>

    <div class="overlay" id="loginOverlay" hidden>
      <div class="card">
        <div class="cardTitle">欢迎回来</div>
        <div class="cardText">输入昵称开始游戏（本地保存，不联网）。</div>
        <label class="field">
          <span class="fieldLabel">昵称</span>
          <input class="input" id="nameInput" maxlength="12" placeholder="比如：小明" />
        </label>
        <button class="btn full" id="loginBtn" type="button">进入游戏</button>
      </div>
    </div>

    <div class="overlay" id="resultOverlay" hidden>
      <div class="card">
        <div class="cardTitle" id="resultTitle">结果</div>
        <div class="cardText" id="resultText">-</div>
        <div class="row">
          <button class="btn ghost full" id="nextBtn" type="button">下一关</button>
          <button class="btn full" id="retryBtn" type="button">再来一次</button>
        </div>
      </div>
    </div>

    <div class="overlay" id="settingsOverlay" hidden>
      <div class="card">
        <div class="cardTitle">设置</div>
        <div class="cardText">音效与震动仅在支持的设备上生效。</div>
        <div class="switchRow">
          <div>
            <div class="switchTitle">音效</div>
            <div class="switchHint">消除/交换/表扬提示音</div>
          </div>
          <label class="switch">
            <input type="checkbox" id="soundToggle" />
            <span class="slider"></span>
          </label>
        </div>
        <div class="switchRow">
          <div>
            <div class="switchTitle">震动</div>
            <div class="switchHint">轻微震动反馈</div>
          </div>
          <label class="switch">
            <input type="checkbox" id="vibrateToggle" />
            <span class="slider"></span>
          </label>
        </div>
        <button class="btn full ghost" id="closeSettingsBtn" type="button">关闭</button>
      </div>
    </div>

    <div class="overlay" id="menuOverlay" hidden>
      <div class="card">
        <div class="cardTitle">主菜单</div>
        <div class="cardText">选择一个选项继续游戏</div>
        <button class="btn full" id="continueBtn" type="button">继续游戏</button>
        <div class="row">
          <button class="btn full ghost" id="levelSelectBtn" type="button">选择关卡</button>
          <button class="btn full ghost" id="restartGameBtn" type="button">重新开始</button>
        </div>
      </div>
    </div>

    <div class="overlay" id="levelSelectOverlay" hidden>
      <div class="card levelSelectCard">
        <div class="cardTitle">选择关卡</div>
        <div class="cardText">点击关卡开始游戏</div>
        <div class="levelGrid" id="levelGrid"></div>
        <button class="btn full ghost" id="closeLevelSelectBtn" type="button">返回</button>
      </div>
    </div>

    <div class="overlay" id="levelConfirmOverlay" hidden>
      <div class="card">
        <div class="cardTitle" id="levelConfirmTitle">关卡 X</div>
        <div class="cardText" id="levelConfirmText">最高记录：0分</div>
        <div class="row">
          <button class="btn ghost full" id="cancelLevelBtn" type="button">退出</button>
          <button class="btn full" id="enterLevelBtn" type="button">进入</button>
        </div>
      </div>
    </div>

    <script src="game.js"></script>
  </body>
</html>
